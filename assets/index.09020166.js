import{a as C,o as N,l as W,b as U}from"./vendor.4900d454.js";const q=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const L of d.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&l(L)}).observe(document,{childList:!0,subtree:!0});function m(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerpolicy&&(d.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?d.credentials="include":r.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(r){if(r.ep)return;r.ep=!0;const d=m(r);fetch(r.href,d)}};q();let n,F,y,g,s,H,p,B=!1;async function R(){if(F=await C(N.MoveNet,{modelType:W.modelType.SINGLEPOSE_LIGHTNING}),navigator.mediaDevices.getUserMedia){let t=await navigator.mediaDevices.getUserMedia({video:!0}).catch(()=>alert("Could not get webcam access"));n=document.createElement("video"),n.addEventListener("loadeddata",()=>{n.play(),A(),B=!0,Q(),requestAnimationFrame(G)}),n.srcObject=t,n.style.transform="scaleX(-1)"}}async function j(){const t=await F.estimatePoses(n);if(t.length<1)return!1;const i=t[0];for(let m=0;m<i.keypoints.length;m++){const l=i.keypoints[m];l.name==D&&(y=l),l.name==_&&(g=l),l.name==O&&(s=l)}return y==null||g==null||s==null||y.score<b||g.score<b||s.score<b?!1:(H=Math.abs(s.x-g.x),p=X(H),!0)}const u=["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4"],b=.2,K=500,V=100;function X(t){let i=t/n.videoWidth*(u.length-5);return i=Math.floor(i),i=u.length-5-i,i=Math.max(i,0),i=Math.min(i,u.length-5),i}var a=(t=>(t[t.Single=0]="Single",t[t.Third=1]="Third",t[t.Fifth=2]="Fifth",t[t.Triad=3]="Triad",t[t.PowerChord=4]="PowerChord",t[t.PowerChordTriad=5]="PowerChordTriad",t))(a||{});let M,h,T=0,P=!1,I=performance.now(),k=!1;async function A(){M=new AudioContext,await M.resume(),h=await U.exports.instrument(M,"distortion_guitar",{soundfont:"FluidR3_GM"}),k=!0,h.play("C3"),h.play("E3"),h.play("G3")}function Y(){Math.abs(y.y-T)<V||((y.y>T&&!P||w)&&performance.now()-I>K?(I=performance.now(),P=!0,h.stop(),h.play(u[p]),(o==3||o==1||o==5)&&h.play(u[p+2]),(o==3||o==2)&&h.play(u[p+4]),(o==4||o==5)&&p<u.length-8&&h.play(u[p+7])):P=!1,T=y.y)}let z=document.getElementById("currentnote"),v=!1,D="right_wrist",_="left_wrist",O="right_hip",w=!1,o=a.Single,x=!1;function J(){document.getElementById("button").addEventListener("click",async()=>{document.getElementById("overlay").style.display="none",A()});let t=document.getElementById("leftHanded");t.addEventListener("click",()=>{v=!v,t.innerHTML=v?"Lefthanded is on":"Lefthanded is off",D=v?"left_wrist":"right_wrist",_=v?"right_wrist":"left_wrist",O=v?"left_hip":"right_hip"});let i=document.getElementById("fullchord");i.addEventListener("click",()=>{o==a.Single?(o=a.Third,i.innerHTML="Third"):o==a.Third?(o=a.Fifth,i.innerHTML="Fifth"):o==a.Fifth?(o=a.Triad,i.innerHTML="Triad"):o==a.Triad?(o=a.PowerChord,i.innerHTML="PowerChord"):o==a.PowerChord?(o=a.PowerChordTriad,i.innerHTML="PowerChordTriad"):o==a.PowerChordTriad&&(o=a.Single,i.innerHTML="Single")});let m=document.getElementById("doublestroke");m.addEventListener("click",()=>{w=!w,m.innerHTML=w?"Double Stroke":"Single Stroke"});let l=document.getElementById("debugoverlaybutton");l.addEventListener("click",()=>{x=!x,l.innerHTML=x?"Debug Overlay is on":"Debug Overlay is off"})}function Q(){document.getElementById("status").innerHTML="Loaded Model"}function Z(){z.innerHTML=u[p]}let e,c,f,S=performance.now();function $(){let t=document.getElementsByTagName("canvas").item(0);c=t.width,f=t.height,e=t.getContext("2d"),e.translate(c,0),e.scale(-1,1)}function ee(){e.clearRect(0,0,c,f),e.drawImage(n,0,0,c,f)}function te(){let t=(1/((performance.now()-S)/1e3)).toFixed(0);S=performance.now(),e.textAlign="left",e.font="50px Arial",e.fillStyle="rgb(0, 0, 0)",e.save(),e.translate(c-20,70),e.scale(-1,1),e.fillText("FPS: "+t,0,0),e.restore(),x&&(e.fillStyle="rgb(255, 0, 0)",e.beginPath(),e.arc(y.x*c/n.videoWidth,y.y*f/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(g.x*c/n.videoWidth,g.y*f/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(s.x*c/n.videoWidth,s.y*f/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.moveTo(g.x*c/n.videoWidth,s.y*f/n.videoHeight),e.lineTo(s.x*c/n.videoWidth,s.y*f/n.videoHeight),e.closePath(),e.stroke(),e.textAlign="center",e.font="100px Arial",e.save(),e.translate((g.x+s.x)/2*c/n.videoWidth,(s.y-20)*f/n.videoHeight),e.scale(-1,1),e.fillText(H.toFixed(0),0,0),e.restore())}async function ie(){$(),J(),R()}ie();let E=!1;async function G(){ee(),k&&B&&(E=await j()||E,E&&(te(),Z(),Y())),requestAnimationFrame(G)}
