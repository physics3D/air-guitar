import{a as C,o as N,l as W,b as U}from"./vendor.4900d454.js";const q=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const b of d.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&a(b)}).observe(document,{childList:!0,subtree:!0});function m(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerpolicy&&(d.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?d.credentials="include":r.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(r){if(r.ep)return;r.ep=!0;const d=m(r);fetch(r.href,d)}};q();let n,F,p,y,s,w,u,B=!1;async function R(){if(F=await C(N.MoveNet,{modelType:W.modelType.SINGLEPOSE_LIGHTNING}),navigator.mediaDevices.getUserMedia){let t=await navigator.mediaDevices.getUserMedia({video:!0}).catch(()=>alert("Could not get webcam access"));n=document.createElement("video"),n.addEventListener("loadeddata",()=>{n.play(),A(),B=!0,Q(),requestAnimationFrame(G)}),n.srcObject=t,n.style.transform="scaleX(-1)"}}async function j(){const t=await F.estimatePoses(n);if(t.length<1)return!1;const i=t[0];for(let m=0;m<i.keypoints.length;m++){const a=i.keypoints[m];a.name==D&&(p=a),a.name==_&&(y=a),a.name==O&&(s=a)}return p==null||y==null||s==null||p.score<M||y.score<M||s.score<M?(console.log("error"),!1):(w=Math.abs(s.x-y.x),u=X(w),console.log(w),console.log(u),console.log(f[u],f[u+4]),!0)}const f=["C1","D1","E1","F1","G1","A1","B1","C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4"],M=.2,K=500,V=100;function X(t){let i=t/n.videoWidth*(f.length-5);return i=Math.floor(i),i=f.length-5-i,i=Math.max(i,0),i=Math.min(i,f.length-5),i}var l=(t=>(t[t.Single=0]="Single",t[t.Third=1]="Third",t[t.Fifth=2]="Fifth",t[t.Triad=3]="Triad",t[t.PowerChord=4]="PowerChord",t[t.PowerChordTriad=5]="PowerChordTriad",t))(l||{});let T,g,P=0,E=!1,I=performance.now(),k=!1;async function A(){T=new AudioContext,await T.resume(),g=await U.exports.instrument(T,"distortion_guitar",{soundfont:"FluidR3_GM"}),k=!0,g.play("C3"),g.play("E3"),g.play("G3")}function Y(){Math.abs(p.y-P)<V||((p.y>P&&!E||x)&&performance.now()-I>K?(I=performance.now(),E=!0,g.stop(),g.play(f[u]),(o==3||o==1||o==5)&&g.play(f[u+2]),(o==3||o==2)&&g.play(f[u+4]),(o==4||o==5)&&u<f.length-8&&g.play(f[u+7])):E=!1,P=p.y)}let z=document.getElementById("currentnote"),v=!1,D="right_wrist",_="left_wrist",O="right_hip",x=!1,o=l.Single,L=!1;function J(){document.getElementById("button").addEventListener("click",async()=>{document.getElementById("overlay").style.display="none",A()});let t=document.getElementById("leftHanded");t.addEventListener("click",()=>{console.log("hi"),v=!v,t.innerHTML=v?"Lefthanded is on":"Lefthanded is off",D=v?"left_wrist":"right_wrist",_=v?"right_wrist":"left_wrist",O=v?"left_hip":"right_hip"});let i=document.getElementById("fullchord");i.addEventListener("click",()=>{o==l.Single?(o=l.Third,i.innerHTML="Third"):o==l.Third?(o=l.Fifth,i.innerHTML="Fifth"):o==l.Fifth?(o=l.Triad,i.innerHTML="Triad"):o==l.Triad?(o=l.PowerChord,i.innerHTML="PowerChord"):o==l.PowerChord?(o=l.PowerChordTriad,i.innerHTML="PowerChordTriad"):o==l.PowerChordTriad&&(o=l.Single,i.innerHTML="Single")});let m=document.getElementById("doublestroke");m.addEventListener("click",()=>{x=!x,m.innerHTML=x?"Double Stroke":"Single Stroke"});let a=document.getElementById("debugoverlaybutton");a.addEventListener("click",()=>{L=!L,a.innerHTML=L?"Debug Overlay is on":"Debug Overlay is off"})}function Q(){document.getElementById("status").innerHTML="Loaded Model"}function Z(){z.innerHTML=f[u]}let e,c,h,S=performance.now();function $(){let t=document.getElementsByTagName("canvas").item(0);c=t.width,h=t.height,e=t.getContext("2d"),e.translate(c,0),e.scale(-1,1)}function ee(){e.clearRect(0,0,c,h),e.drawImage(n,0,0,c,h)}function te(){let t=(1/((performance.now()-S)/1e3)).toFixed(0);S=performance.now(),e.textAlign="left",e.font="50px Arial",e.fillStyle="rgb(0, 0, 0)",e.save(),e.translate(c-20,70),e.scale(-1,1),e.fillText("FPS: "+t,0,0),e.restore(),L&&(e.fillStyle="rgb(255, 0, 0)",e.beginPath(),e.arc(p.x*c/n.videoWidth,p.y*h/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(y.x*c/n.videoWidth,y.y*h/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.arc(s.x*c/n.videoWidth,s.y*h/n.videoHeight,10,0,2*Math.PI),e.fill(),e.beginPath(),e.moveTo(y.x*c/n.videoWidth,s.y*h/n.videoHeight),e.lineTo(s.x*c/n.videoWidth,s.y*h/n.videoHeight),e.closePath(),e.stroke(),e.textAlign="center",e.font="100px Arial",e.save(),e.translate((y.x+s.x)/2*c/n.videoWidth,(s.y-20)*h/n.videoHeight),e.scale(-1,1),e.fillText(w.toFixed(0),0,0),e.restore())}async function ie(){$(),J(),R()}ie();let H=!1;async function G(){ee(),k&&B&&(H=await j()||H,H&&(te(),Z(),Y())),requestAnimationFrame(G)}
